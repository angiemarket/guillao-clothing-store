{"ast":null,"code":"import _objectSpread from\"C:/Users/angel/OneDrive/Pictures/Karen Sutton Hair Studio/guillao-clothing-store/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/angel/OneDrive/Pictures/Karen Sutton Hair Studio/guillao-clothing-store/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\angel\\\\OneDrive\\\\Pictures\\\\Karen Sutton Hair Studio\\\\guillao-clothing-store\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{initializeApp}from'firebase/app';import{getAuth,signInWithRedirect,signInWithPopup,GoogleAuthProvider,createUserWithEmailAndPassword,signInWithEmailAndPassword,signOut,onAuthStateChanged}from'firebase/auth';import{getFirestore,doc,getDoc,setDoc,collection,writeBatch,query,getDocs}from'firebase/firestore';var firebaseConfig={apiKey:'AIzaSyDDU4V-_QV3M8GyhC9SVieRTDM4dbiT0Yk',authDomain:'crwn-clothing-db-98d4d.firebaseapp.com',projectId:'crwn-clothing-db-98d4d',storageBucket:'crwn-clothing-db-98d4d.appspot.com',messagingSenderId:'626766232035',appId:'1:626766232035:web:506621582dab103a4d08d6'};var firebaseApp=initializeApp(firebaseConfig);var googleProvider=new GoogleAuthProvider();googleProvider.setCustomParameters({prompt:'select_account'});export var auth=getAuth();export var signInWithGooglePopup=function signInWithGooglePopup(){return signInWithPopup(auth,googleProvider);};export var signInWithGoogleRedirect=function signInWithGoogleRedirect(){return signInWithRedirect(auth,googleProvider);};export var db=getFirestore();export var addCollectionAndDocuments=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(collectionKey,objectsToAdd){var collectionRef,batch;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:collectionRef=collection(db,collectionKey);batch=writeBatch(db);objectsToAdd.forEach(function(object){var docRef=doc(collectionRef,object.title.toLowerCase());batch.set(docRef,object);});_context.next=5;return batch.commit();case 5:console.log('done');case 6:case\"end\":return _context.stop();}}},_callee);}));return function addCollectionAndDocuments(_x,_x2){return _ref.apply(this,arguments);};}();export var getCategoriesAndDocuments=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var collectionRef,q,querySnapshot;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:collectionRef=collection(db,'categories');q=query(collectionRef);_context2.next=4;return getDocs(q);case 4:querySnapshot=_context2.sent;return _context2.abrupt(\"return\",querySnapshot.docs.map(function(docSnapshot){return docSnapshot.data();}));case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function getCategoriesAndDocuments(){return _ref2.apply(this,arguments);};}();export var createUserDocumentFromAuth=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(userAuth){var additionalInformation,userDocRef,userSnapshot,displayName,email,createdAt,_args3=arguments;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:additionalInformation=_args3.length>1&&_args3[1]!==undefined?_args3[1]:{};if(userAuth){_context3.next=3;break;}return _context3.abrupt(\"return\");case 3:userDocRef=doc(db,'users',userAuth.uid);_context3.next=6;return getDoc(userDocRef);case 6:userSnapshot=_context3.sent;if(userSnapshot.exists()){_context3.next=18;break;}displayName=userAuth.displayName,email=userAuth.email;createdAt=new Date();_context3.prev=10;_context3.next=13;return setDoc(userDocRef,_objectSpread({displayName:displayName,email:email,createdAt:createdAt},additionalInformation));case 13:_context3.next=18;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](10);console.log('error creating the user',_context3.t0);case 18:return _context3.abrupt(\"return\",userSnapshot);case 19:case\"end\":return _context3.stop();}}},_callee3,null,[[10,15]]);}));return function createUserDocumentFromAuth(_x3){return _ref3.apply(this,arguments);};}();export var createAuthUserWithEmailAndPassword=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(email,password){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(!email||!password)){_context4.next=2;break;}return _context4.abrupt(\"return\");case 2:_context4.next=4;return createUserWithEmailAndPassword(auth,email,password);case 4:return _context4.abrupt(\"return\",_context4.sent);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function createAuthUserWithEmailAndPassword(_x4,_x5){return _ref4.apply(this,arguments);};}();export var signInAuthUserWithEmailAndPassword=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(email,password){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!(!email||!password)){_context5.next=2;break;}return _context5.abrupt(\"return\");case 2:_context5.next=4;return signInWithEmailAndPassword(auth,email,password);case 4:return _context5.abrupt(\"return\",_context5.sent);case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function signInAuthUserWithEmailAndPassword(_x6,_x7){return _ref5.apply(this,arguments);};}();export var signOutUser=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return signOut(auth);case 2:return _context6.abrupt(\"return\",_context6.sent);case 3:case\"end\":return _context6.stop();}}},_callee6);}));return function signOutUser(){return _ref6.apply(this,arguments);};}();export var onAuthStateChangedListener=function onAuthStateChangedListener(callback){return onAuthStateChanged(auth,callback);};export var getCurrentUser=function getCurrentUser(){return new Promise(function(resolve,reject){var unsubscribe=onAuthStateChanged(auth,function(userAuth){unsubscribe();resolve(userAuth);},reject);});};","map":{"version":3,"sources":["C:/Users/angel/OneDrive/Pictures/Karen Sutton Hair Studio/guillao-clothing-store/src/utils/firebase/firebase.utils.ts"],"names":["initializeApp","getAuth","signInWithRedirect","signInWithPopup","GoogleAuthProvider","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","onAuthStateChanged","getFirestore","doc","getDoc","setDoc","collection","writeBatch","query","getDocs","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","firebaseApp","googleProvider","setCustomParameters","prompt","auth","signInWithGooglePopup","signInWithGoogleRedirect","db","addCollectionAndDocuments","collectionKey","objectsToAdd","collectionRef","batch","forEach","object","docRef","title","toLowerCase","set","commit","console","log","getCategoriesAndDocuments","q","querySnapshot","docs","map","docSnapshot","data","createUserDocumentFromAuth","userAuth","additionalInformation","userDocRef","uid","userSnapshot","exists","displayName","email","createdAt","Date","createAuthUserWithEmailAndPassword","password","signInAuthUserWithEmailAndPassword","signOutUser","onAuthStateChangedListener","callback","getCurrentUser","Promise","resolve","reject","unsubscribe"],"mappings":"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","sourcesContent":["import { initializeApp } from 'firebase/app';\nimport {\n  getAuth,\n  signInWithRedirect,\n  signInWithPopup,\n  GoogleAuthProvider,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  signOut,\n  onAuthStateChanged,\n  NextOrObserver,\n  User,\n} from 'firebase/auth';\nimport {\n  getFirestore,\n  doc,\n  getDoc,\n  setDoc,\n  collection,\n  writeBatch,\n  query,\n  getDocs,\n  QueryDocumentSnapshot,\n} from 'firebase/firestore';\n\nimport { Category } from '../../store/categories/category.types';\n\nconst firebaseConfig = {\n  apiKey: 'AIzaSyDDU4V-_QV3M8GyhC9SVieRTDM4dbiT0Yk',\n  authDomain: 'crwn-clothing-db-98d4d.firebaseapp.com',\n  projectId: 'crwn-clothing-db-98d4d',\n  storageBucket: 'crwn-clothing-db-98d4d.appspot.com',\n  messagingSenderId: '626766232035',\n  appId: '1:626766232035:web:506621582dab103a4d08d6',\n};\n\nconst firebaseApp = initializeApp(firebaseConfig);\n\nconst googleProvider = new GoogleAuthProvider();\n\ngoogleProvider.setCustomParameters({\n  prompt: 'select_account',\n});\n\nexport const auth = getAuth();\nexport const signInWithGooglePopup = () =>\n  signInWithPopup(auth, googleProvider);\nexport const signInWithGoogleRedirect = () =>\n  signInWithRedirect(auth, googleProvider);\n\nexport const db = getFirestore();\n\nexport type ObjectToAdd = {\n  title: string;\n};\n\nexport const addCollectionAndDocuments = async <T extends ObjectToAdd>(\n  collectionKey: string,\n  objectsToAdd: T[]\n): Promise<void> => {\n  const collectionRef = collection(db, collectionKey);\n  const batch = writeBatch(db);\n\n  objectsToAdd.forEach((object) => {\n    const docRef = doc(collectionRef, object.title.toLowerCase());\n    batch.set(docRef, object);\n  });\n\n  await batch.commit();\n  console.log('done');\n};\n\nexport const getCategoriesAndDocuments = async (): Promise<Category[]> => {\n  const collectionRef = collection(db, 'categories');\n  const q = query(collectionRef);\n\n  const querySnapshot = await getDocs(q);\n  return querySnapshot.docs.map(\n    (docSnapshot) => docSnapshot.data() as Category\n  );\n};\n\nexport type AdditionalInformation = {\n  displayName?: string;\n};\n\nexport type UserData = {\n  createdAt: Date;\n  displayName: string;\n  email: string;\n};\n\nexport const createUserDocumentFromAuth = async (\n  userAuth: User,\n  additionalInformation = {} as AdditionalInformation\n): Promise<void | QueryDocumentSnapshot<UserData>> => {\n  if (!userAuth) return;\n\n  const userDocRef = doc(db, 'users', userAuth.uid);\n\n  const userSnapshot = await getDoc(userDocRef);\n\n  if (!userSnapshot.exists()) {\n    const { displayName, email } = userAuth;\n    const createdAt = new Date();\n\n    try {\n      await setDoc(userDocRef, {\n        displayName,\n        email,\n        createdAt,\n        ...additionalInformation,\n      });\n    } catch (error) {\n      console.log('error creating the user', error);\n    }\n  }\n\n  return userSnapshot as QueryDocumentSnapshot<UserData>;\n};\n\nexport const createAuthUserWithEmailAndPassword = async (\n  email: string,\n  password: string\n) => {\n  if (!email || !password) return;\n\n  return await createUserWithEmailAndPassword(auth, email, password);\n};\n\nexport const signInAuthUserWithEmailAndPassword = async (\n  email: string,\n  password: string\n) => {\n  if (!email || !password) return;\n\n  return await signInWithEmailAndPassword(auth, email, password);\n};\n\nexport const signOutUser = async () => await signOut(auth);\n\nexport const onAuthStateChangedListener = (callback: NextOrObserver<User>) =>\n  onAuthStateChanged(auth, callback);\n\nexport const getCurrentUser = (): Promise<User | null> => {\n  return new Promise((resolve, reject) => {\n    const unsubscribe = onAuthStateChanged(\n      auth,\n      (userAuth) => {\n        unsubscribe();\n        resolve(userAuth);\n      },\n      reject\n    );\n  });\n};\n"]},"metadata":{},"sourceType":"module"}